Line profiler for grid_sizes = 100

Timer unit: 1e-06 s

Total time: 40.5297 s
File: .\gauss_seidel.py
Function: gauss_seidel at line 6

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
     6                                           @profile
     7                                           def gauss_seidel(f, iterations=1000):
     8         1         46.3     46.3      0.0      newf = np.copy(f)
     9         1          1.9      1.9      0.0      rows, cols = newf.shape
    10
    11      1001        454.6      0.5      0.0      for _ in range(iterations):
    12     99000      33656.0      0.3      0.1          for i in range(1, rows - 1):
    13   9702000    4266546.7      0.4     10.5              for j in range(1, cols - 1):
    14  28812000   24213322.3      0.8     59.7                  newf[i, j] = 0.25 * (newf[i, j + 1] + newf[i, j - 1] +
    15  19208000   12015657.9      0.6     29.6                                       newf[i + 1, j] + newf[i - 1, j])
    16         1          4.2      4.2      0.0      return newf


We can notice the line 14 and 15 taking the most % of time taken for the execution, being followed by the line 13



Cyhton


[[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.17567902e-55 2.07630141e-55 2.62868986e-55
  2.80896283e-55 2.63956165e-55 2.18120658e-55 1.52131617e-55
  7.60658083e-56 0.00000000e+00]
 [0.00000000e+00 2.07630141e-55 3.66684056e-55 4.64238311e-55
  4.96075320e-55 4.66158318e-55 3.85210776e-55 2.68671196e-55
  1.34335598e-55 0.00000000e+00]
 [0.00000000e+00 2.62868986e-55 4.64238311e-55 5.87746334e-55
  6.28053403e-55 5.90177148e-55 4.87693962e-55 3.40149675e-55
  1.70074837e-55 0.00000000e+00]
 [0.00000000e+00 2.80896283e-55 4.96075320e-55 6.28053403e-55
  6.71124691e-55 6.30650919e-55 5.21139536e-55 3.63476807e-55
  1.81738403e-55 0.00000000e+00]
 [0.00000000e+00 2.63956165e-55 4.66158318e-55 5.90177148e-55
  6.30650919e-55 5.92618015e-55 4.89710977e-55 3.41556473e-55
  1.70778236e-55 0.00000000e+00]
 [0.00000000e+00 2.18120658e-55 3.85210776e-55 4.87693962e-55
  5.21139536e-55 4.89710977e-55 4.04673558e-55 2.82245814e-55
  1.41122907e-55 0.00000000e+00]
 [0.00000000e+00 1.52131617e-55 2.68671196e-55 3.40149675e-55
  3.63476807e-55 3.41556473e-55 2.82245814e-55 1.96856696e-55
  9.84283478e-56 0.00000000e+00]
 [0.00000000e+00 7.60658083e-56 1.34335598e-55 1.70074837e-55
  1.81738403e-55 1.70778236e-55 1.41122907e-55 9.84283478e-56
  4.92141739e-56 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00]]
Grid size: 10x10, Time taken: 0.0001 seconds
[[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 3.11503317e-14 6.06128525e-14 8.76351073e-14
  1.11551136e-13 1.31797172e-13 1.47924148e-13 1.59606753e-13
  1.66648893e-13 1.68985504e-13 1.66680762e-13 1.59922847e-13
  1.49015482e-13 1.34366579e-13 1.16474358e-13 9.59114112e-14
  7.33071707e-14 4.93293179e-14 2.46646590e-14 0.00000000e+00]
 [0.00000000e+00 6.06128525e-14 1.17941534e-13 1.70521903e-13
  2.17058124e-13 2.56453210e-13 2.87833358e-13 3.10565573e-13
  3.24268290e-13 3.28814907e-13 3.24330300e-13 3.11180632e-13
  2.89956895e-13 2.61452805e-13 2.26637814e-13 1.86626078e-13
  1.42642357e-13 9.59858373e-14 4.79929187e-14 0.00000000e+00]
 [0.00000000e+00 8.76351073e-14 1.70521903e-13 2.46543507e-13
  3.13826378e-13 3.70784473e-13 4.16154432e-13 4.49021059e-13
  4.68832684e-13 4.75406261e-13 4.68922339e-13 4.49910323e-13
  4.19224678e-13 3.78012974e-13 3.27676859e-13 2.69827201e-13
  2.06234779e-13 1.38777979e-13 6.93889893e-14 0.00000000e+00]
 [0.00000000e+00 1.11551136e-13 2.17058124e-13 3.13826378e-13
  3.99471057e-13 4.71973282e-13 5.29724914e-13 5.71560996e-13
  5.96779306e-13 6.05146843e-13 5.96893428e-13 5.72692944e-13
  5.33633043e-13 4.81174474e-13 4.17101399e-13 3.43464300e-13
  2.62517210e-13 1.76651135e-13 8.83255674e-14 0.00000000e+00]
 [0.00000000e+00 1.31797172e-13 2.56453210e-13 3.70784473e-13
  4.71973282e-13 5.57634338e-13 6.25867636e-13 6.75296782e-13
  7.05092103e-13 7.14978310e-13 7.05226938e-13 6.76634174e-13
  6.30485074e-13 5.68505506e-13 4.92803452e-13 4.05801547e-13
  3.10162919e-13 2.08712532e-13 1.04356266e-13 0.00000000e+00]
 [0.00000000e+00 1.47924148e-13 2.87833358e-13 4.16154432e-13
  5.29724914e-13 6.25867636e-13 7.02450102e-13 7.57927501e-13
  7.91368639e-13 8.02464543e-13 7.91519973e-13 7.59428538e-13
  7.07632539e-13 6.38069022e-13 5.53103908e-13 4.55456268e-13
  3.48115099e-13 2.34251032e-13 1.17125516e-13 0.00000000e+00]
 [0.00000000e+00 1.59606753e-13 3.10565573e-13 4.49021059e-13
  5.71560996e-13 6.75296782e-13 7.57927501e-13 8.17786338e-13
  8.53868557e-13 8.65840783e-13 8.54031843e-13 8.19405923e-13
  7.63519231e-13 6.88461797e-13 5.96786393e-13 4.91426836e-13
  3.75608184e-13 2.52751475e-13 1.26375737e-13 0.00000000e+00]
 [0.00000000e+00 1.66648893e-13 3.24268290e-13 4.68832684e-13
  5.96779306e-13 7.05092103e-13 7.91368639e-13 8.53868557e-13
  8.91542790e-13 9.04043251e-13 8.91713280e-13 8.55559601e-13
  7.97207087e-13 7.18837983e-13 6.23117693e-13 5.13109481e-13
  3.92180699e-13 2.63903329e-13 1.31951664e-13 0.00000000e+00]
 [0.00000000e+00 1.68985504e-13 3.28814907e-13 4.75406261e-13
  6.05146843e-13 7.14978310e-13 8.02464543e-13 8.65840783e-13
  9.04043251e-13 9.16718984e-13 9.04216132e-13 8.67555537e-13
  8.08384853e-13 7.28916923e-13 6.31854524e-13 5.20303870e-13
  3.97679526e-13 2.67603559e-13 1.33801780e-13 0.00000000e+00]
 [0.00000000e+00 1.66680762e-13 3.24330300e-13 4.68922339e-13
  5.96893428e-13 7.05226938e-13 7.91519973e-13 8.54031843e-13
  8.91713280e-13 9.04216132e-13 8.91883802e-13 8.55723210e-13
  7.97359537e-13 7.18975446e-13 6.23236852e-13 5.13207603e-13
  3.92255696e-13 2.63953795e-13 1.31976898e-13 0.00000000e+00]
 [0.00000000e+00 1.59922847e-13 3.11180632e-13 4.49910323e-13
  5.72692944e-13 6.76634174e-13 7.59428538e-13 8.19405923e-13
  8.55559601e-13 8.67555537e-13 8.55723210e-13 8.21028716e-13
  7.65031343e-13 6.89825261e-13 5.97968299e-13 4.92400082e-13
  3.76352057e-13 2.53252036e-13 1.26626018e-13 0.00000000e+00]
 [0.00000000e+00 1.49015482e-13 2.89956895e-13 4.19224678e-13
  5.33633043e-13 6.30485074e-13 7.07632539e-13 7.63519231e-13
  7.97207087e-13 8.08384853e-13 7.97359537e-13 7.65031343e-13
  7.12853210e-13 6.42776477e-13 5.57184519e-13 4.58816469e-13
  3.50683373e-13 2.35979256e-13 1.17989628e-13 0.00000000e+00]
 [0.00000000e+00 1.34366579e-13 2.61452805e-13 3.78012974e-13
  4.81174474e-13 5.68505506e-13 6.38069022e-13 6.88461797e-13
  7.18837983e-13 7.28916923e-13 7.18975446e-13 6.89825261e-13
  6.42776477e-13 5.79588609e-13 5.02410732e-13 4.13712711e-13
  3.16209593e-13 2.12781415e-13 1.06390708e-13 0.00000000e+00]
 [0.00000000e+00 1.16474358e-13 2.26637814e-13 3.27676859e-13
  4.17101399e-13 4.92803452e-13 5.53103908e-13 5.96786393e-13
  6.23117693e-13 6.31854524e-13 6.23236852e-13 5.97968299e-13
  5.57184519e-13 5.02410732e-13 4.35509842e-13 3.58622828e-13
  2.74103201e-13 1.84447494e-13 9.22237471e-14 0.00000000e+00]
 [0.00000000e+00 9.59114112e-14 1.86626078e-13 2.69827201e-13
  3.43464300e-13 4.05801547e-13 4.55456268e-13 4.91426836e-13
  5.13109481e-13 5.20303870e-13 5.13207603e-13 4.92400082e-13
  4.58816469e-13 4.13712711e-13 3.58622828e-13 2.95309818e-13
  2.25711696e-13 1.51884241e-13 7.59421206e-14 0.00000000e+00]
 [0.00000000e+00 7.33071707e-14 1.42642357e-13 2.06234779e-13
  2.62517210e-13 3.10162919e-13 3.48115099e-13 3.75608184e-13
  3.92180699e-13 3.97679526e-13 3.92255696e-13 3.76352057e-13
  3.50683373e-13 3.16209593e-13 2.74103201e-13 2.25711696e-13
  1.72516342e-13 1.16088418e-13 5.80442090e-14 0.00000000e+00]
 [0.00000000e+00 4.93293179e-14 9.59858373e-14 1.38777979e-13
  1.76651135e-13 2.08712532e-13 2.34251032e-13 2.52751475e-13
  2.63903329e-13 2.67603559e-13 2.63953795e-13 2.53252036e-13
  2.35979256e-13 2.12781415e-13 1.84447494e-13 1.51884241e-13
  1.16088418e-13 7.81173577e-14 3.90586789e-14 0.00000000e+00]
 [0.00000000e+00 2.46646590e-14 4.79929187e-14 6.93889893e-14
  8.83255674e-14 1.04356266e-13 1.17125516e-13 1.26375737e-13
  1.31951664e-13 1.33801780e-13 1.31976898e-13 1.26626018e-13
  1.17989628e-13 1.06390708e-13 9.22237471e-14 7.59421206e-14
  5.80442090e-14 3.90586789e-14 1.95293394e-14 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00]]
Grid size: 20x20, Time taken: 0.0006 seconds
[[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 5.88453336e-05 1.17207855e-04 ... 1.06888547e-04
  5.34443405e-05 0.00000000e+00]
 [0.00000000e+00 1.17207918e-04 2.33454170e-04 ... 2.12899907e-04
  1.06450087e-04 0.00000000e+00]
 ...
 [0.00000000e+00 1.06904777e-04 2.12932036e-04 ... 1.94162821e-04
  9.70813912e-05 0.00000000e+00]
 [0.00000000e+00 5.34524560e-05 1.06466151e-04 ... 9.70814306e-05
  4.85407055e-05 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]]
Grid size: 50x50, Time taken: 0.0065 seconds
[[0.         0.         0.         ... 0.         0.         0.        ]
 [0.         0.00031622 0.00063173 ... 0.00062399 0.000312   0.        ]
 [0.         0.00063172 0.00126202 ... 0.00124656 0.00062329 0.        ]
 ...
 [0.         0.00060801 0.00121467 ... 0.00119824 0.00059913 0.        ]
 [0.         0.00030401 0.00060735 ... 0.00059911 0.00029956 0.        ]
 [0.         0.         0.         ... 0.         0.         0.        ]]
Grid size: 100x100, Time taken: 0.0389 seconds




PyTorch

GPU

NVIDIA Tesla T4:
CUDA Cores: 2560.
Memory: 16 GB GDDR6.
Memory Bandwidth: 320 GB/s.
FP32 Performance: 8.1 TFLOPS.


Grid size: 10x10, Time taken: 0.1383 seconds
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 8.8439e-29, 1.5800e-28, 2.2393e-28, 2.4208e-28, 2.5465e-28,
         2.1288e-28, 1.6621e-28, 8.4072e-29, 0.0000e+00],
        [0.0000e+00, 1.5800e-28, 3.1237e-28, 4.0008e-28, 4.7858e-28, 4.5496e-28,
         4.2086e-28, 2.9695e-28, 1.6621e-28, 0.0000e+00],
        [0.0000e+00, 2.2393e-28, 4.0008e-28, 5.6702e-28, 6.1296e-28, 6.4479e-28,
         5.3903e-28, 4.2086e-28, 2.1288e-28, 0.0000e+00],
        [0.0000e+00, 2.4208e-28, 4.7858e-28, 6.1296e-28, 7.3323e-28, 6.9703e-28,
         6.4479e-28, 4.5496e-28, 2.5465e-28, 0.0000e+00],
        [0.0000e+00, 2.5465e-28, 4.5496e-28, 6.4479e-28, 6.9703e-28, 7.3323e-28,
         6.1296e-28, 4.7858e-28, 2.4208e-28, 0.0000e+00],
        [0.0000e+00, 2.1288e-28, 4.2086e-28, 5.3903e-28, 6.4479e-28, 6.1296e-28,
         5.6702e-28, 4.0008e-28, 2.2393e-28, 0.0000e+00],
        [0.0000e+00, 1.6621e-28, 2.9695e-28, 4.2086e-28, 4.5496e-28, 4.7858e-28,
         4.0008e-28, 3.1237e-28, 1.5800e-28, 0.0000e+00],
        [0.0000e+00, 8.4073e-29, 1.6621e-28, 2.1288e-28, 2.5465e-28, 2.4208e-28,
         2.2393e-28, 1.5800e-28, 8.8439e-29, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00]], device='cuda:0')
Grid size: 20x20, Time taken: 0.1318 seconds
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00],
        [0.0000e+00, 2.3160e-08, 4.7574e-08, 6.6970e-08, 8.9993e-08, 1.0352e-07,
         1.2266e-07, 1.2886e-07, 1.4203e-07, 1.4023e-07, 1.4602e-07, 1.3640e-07,
         1.3418e-07, 1.1780e-07, 1.0780e-07, 8.6425e-08, 6.9735e-08, 4.5688e-08,
         2.4116e-08, 0.0000e+00],
        [0.0000e+00, 4.7574e-08, 9.0129e-08, 1.3757e-07, 1.7049e-07, 2.1265e-07,
         2.3238e-07, 2.6470e-07, 2.6908e-07, 2.8805e-07, 2.7663e-07, 2.8020e-07,
         2.5420e-07, 2.4197e-07, 2.0422e-07, 1.7753e-07, 1.3211e-07, 9.3851e-08,
         4.5688e-08, 0.0000e+00],
        [0.0000e+00, 6.6970e-08, 1.3757e-07, 1.9365e-07, 2.6023e-07, 2.9935e-07,
         3.5469e-07, 3.7261e-07, 4.1071e-07, 4.0549e-07, 4.2223e-07, 3.9443e-07,
         3.8799e-07, 3.4062e-07, 3.1171e-07, 2.4991e-07, 2.0165e-07, 1.3211e-07,
         6.9735e-08, 0.0000e+00],
        [0.0000e+00, 8.9993e-08, 1.7049e-07, 2.6023e-07, 3.2251e-07, 4.0226e-07,
         4.3958e-07, 5.0071e-07, 5.0901e-07, 5.4489e-07, 5.2328e-07, 5.3003e-07,
         4.8085e-07, 4.5773e-07, 3.8631e-07, 3.3583e-07, 2.4991e-07, 1.7753e-07,
         8.6425e-08, 0.0000e+00],
        [0.0000e+00, 1.0352e-07, 2.1265e-07, 2.9935e-07, 4.0226e-07, 4.6274e-07,
         5.4828e-07, 5.7598e-07, 6.3488e-07, 6.2680e-07, 6.5269e-07, 6.0971e-07,
         5.9976e-07, 5.2654e-07, 4.8184e-07, 3.8631e-07, 3.1171e-07, 2.0422e-07,
         1.0780e-07, 0.0000e+00],
        [0.0000e+00, 1.2266e-07, 2.3238e-07, 3.5469e-07, 4.3958e-07, 5.4828e-07,
         5.9914e-07, 6.8246e-07, 6.9377e-07, 7.4268e-07, 7.1323e-07, 7.2242e-07,
         6.5539e-07, 6.2388e-07, 5.2654e-07, 4.5773e-07, 3.4062e-07, 2.4197e-07,
         1.1780e-07, 0.0000e+00],
        [0.0000e+00, 1.2886e-07, 2.6470e-07, 3.7261e-07, 5.0071e-07, 5.7598e-07,
         6.8246e-07, 7.1693e-07, 7.9026e-07, 7.8020e-07, 8.1242e-07, 7.5892e-07,
         7.4654e-07, 6.5539e-07, 5.9976e-07, 4.8085e-07, 3.8799e-07, 2.5420e-07,
         1.3418e-07, 0.0000e+00],
        [0.0000e+00, 1.4203e-07, 2.6908e-07, 4.1071e-07, 5.0901e-07, 6.3488e-07,
         6.9377e-07, 7.9026e-07, 8.0336e-07, 8.5999e-07, 8.2589e-07, 8.3653e-07,
         7.5892e-07, 7.2242e-07, 6.0971e-07, 5.3003e-07, 3.9443e-07, 2.8020e-07,
         1.3640e-07, 0.0000e+00],
        [0.0000e+00, 1.4023e-07, 2.8805e-07, 4.0549e-07, 5.4489e-07, 6.2680e-07,
         7.4268e-07, 7.8020e-07, 8.5999e-07, 8.4905e-07, 8.8411e-07, 8.2589e-07,
         8.1242e-07, 7.1323e-07, 6.5269e-07, 5.2328e-07, 4.2223e-07, 2.7663e-07,
         1.4602e-07, 0.0000e+00],
        [0.0000e+00, 1.4602e-07, 2.7663e-07, 4.2223e-07, 5.2328e-07, 6.5269e-07,
         7.1323e-07, 8.1242e-07, 8.2589e-07, 8.8411e-07, 8.4905e-07, 8.5999e-07,
         7.8020e-07, 7.4268e-07, 6.2680e-07, 5.4489e-07, 4.0549e-07, 2.8805e-07,
         1.4023e-07, 0.0000e+00],
        [0.0000e+00, 1.3640e-07, 2.8020e-07, 3.9443e-07, 5.3003e-07, 6.0971e-07,
         7.2242e-07, 7.5892e-07, 8.3653e-07, 8.2589e-07, 8.5999e-07, 8.0336e-07,
         7.9026e-07, 6.9377e-07, 6.3488e-07, 5.0901e-07, 4.1071e-07, 2.6908e-07,
         1.4203e-07, 0.0000e+00],
        [0.0000e+00, 1.3418e-07, 2.5420e-07, 3.8799e-07, 4.8085e-07, 5.9976e-07,
         6.5539e-07, 7.4654e-07, 7.5892e-07, 8.1242e-07, 7.8020e-07, 7.9026e-07,
         7.1693e-07, 6.8246e-07, 5.7598e-07, 5.0071e-07, 3.7261e-07, 2.6470e-07,
         1.2886e-07, 0.0000e+00],
        [0.0000e+00, 1.1780e-07, 2.4197e-07, 3.4062e-07, 4.5773e-07, 5.2654e-07,
         6.2388e-07, 6.5539e-07, 7.2242e-07, 7.1323e-07, 7.4268e-07, 6.9377e-07,
         6.8246e-07, 5.9914e-07, 5.4828e-07, 4.3958e-07, 3.5469e-07, 2.3238e-07,
         1.2266e-07, 0.0000e+00],
        [0.0000e+00, 1.0780e-07, 2.0422e-07, 3.1171e-07, 3.8631e-07, 4.8184e-07,
         5.2654e-07, 5.9976e-07, 6.0971e-07, 6.5269e-07, 6.2680e-07, 6.3488e-07,
         5.7598e-07, 5.4828e-07, 4.6274e-07, 4.0226e-07, 2.9935e-07, 2.1265e-07,
         1.0352e-07, 0.0000e+00],
        [0.0000e+00, 8.6425e-08, 1.7753e-07, 2.4991e-07, 3.3583e-07, 3.8631e-07,
         4.5773e-07, 4.8085e-07, 5.3003e-07, 5.2328e-07, 5.4489e-07, 5.0901e-07,
         5.0071e-07, 4.3958e-07, 4.0226e-07, 3.2251e-07, 2.6023e-07, 1.7049e-07,
         8.9993e-08, 0.0000e+00],
        [0.0000e+00, 6.9735e-08, 1.3211e-07, 2.0165e-07, 2.4991e-07, 3.1171e-07,
         3.4062e-07, 3.8799e-07, 3.9443e-07, 4.2223e-07, 4.0549e-07, 4.1071e-07,
         3.7261e-07, 3.5469e-07, 2.9935e-07, 2.6023e-07, 1.9365e-07, 1.3757e-07,
         6.6970e-08, 0.0000e+00],
        [0.0000e+00, 4.5688e-08, 9.3851e-08, 1.3211e-07, 1.7753e-07, 2.0422e-07,
         2.4197e-07, 2.5420e-07, 2.8020e-07, 2.7663e-07, 2.8805e-07, 2.6908e-07,
         2.6470e-07, 2.3238e-07, 2.1265e-07, 1.7049e-07, 1.3757e-07, 9.0129e-08,
         4.7574e-08, 0.0000e+00],
        [0.0000e+00, 2.4116e-08, 4.5688e-08, 6.9735e-08, 8.6425e-08, 1.0780e-07,
         1.1780e-07, 1.3418e-07, 1.3640e-07, 1.4602e-07, 1.4023e-07, 1.4203e-07,
         1.2886e-07, 1.2266e-07, 1.0352e-07, 8.9993e-08, 6.6970e-08, 4.7574e-08,
         2.3160e-08, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00]], device='cuda:0')
Grid size: 40x40, Time taken: 0.1318 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0002, 0.0004,  ..., 0.0004, 0.0002, 0.0000],
        [0.0000, 0.0004, 0.0008,  ..., 0.0008, 0.0004, 0.0000],
        ...,
        [0.0000, 0.0004, 0.0008,  ..., 0.0008, 0.0004, 0.0000],
        [0.0000, 0.0002, 0.0004,  ..., 0.0004, 0.0002, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Grid size: 100x100, Time taken: 0.1324 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0013, 0.0025,  ..., 0.0026, 0.0013, 0.0000],
        ...,
        [0.0000, 0.0013, 0.0026,  ..., 0.0025, 0.0012, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0012, 0.0006, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Grid size: 200x200, Time taken: 0.1322 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0006, 0.0012,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0012, 0.0025,  ..., 0.0025, 0.0013, 0.0000],
        ...,
        [0.0000, 0.0013, 0.0025,  ..., 0.0025, 0.0013, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Grid size: 400x400, Time taken: 0.1399 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0012, 0.0006, 0.0000],
        [0.0000, 0.0013, 0.0025,  ..., 0.0026, 0.0012, 0.0000],
        ...,
        [0.0000, 0.0013, 0.0026,  ..., 0.0026, 0.0013, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Grid size: 600x600, Time taken: 0.1467 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0013, 0.0026,  ..., 0.0025, 0.0013, 0.0000],
        ...,
        [0.0000, 0.0013, 0.0026,  ..., 0.0026, 0.0012, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0012, 0.0006, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Grid size: 800x800, Time taken: 0.1797 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0012, 0.0006, 0.0000],
        [0.0000, 0.0013, 0.0025,  ..., 0.0025, 0.0012, 0.0000],
        ...,
        [0.0000, 0.0013, 0.0025,  ..., 0.0026, 0.0013, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Grid size: 1000x1000, Time taken: 0.3163 seconds
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0013, 0.0025,  ..., 0.0025, 0.0013, 0.0000],
        ...,
        [0.0000, 0.0013, 0.0025,  ..., 0.0025, 0.0013, 0.0000],
        [0.0000, 0.0006, 0.0013,  ..., 0.0013, 0.0006, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')

       